

var LAYER_COUNT = 3;
var MAP = {tw: 60, th:15};
var TILE = 35;
var TILESET_TILE = TILE * 2;
var TILESET_PADDING = 2;
var TILESET_SPACING = 2;
var TILESET_COUNT_X = 14;
var TILESET_COUNT_Y = 14;

var tileset = document.createElement("img")
tileset.src = "tileset.png"

function drawMap()
{
    for(var layeridx=0; layeridx<LATER_COUNT;layeridx++)
    {
        var idx = 0;
        for(var y = 0; y < level1.layers[layeridx].height; y++)
        {
            for(var x = 0; x < level1.layers[layeridx].width; y++)
            {
                if( level1.layers[layeridx].data[idx] != 0)
                {
                    var tileIndex = level1.layers[layeridx].data[idx]-1;
                    var sx = TILESET_PADDING + (tileIndex % TILESET_COUNT_X)*(TILE_SPACING);
                    var sy = TILESET_PADDING + (Math.floor(tileIndex / TILESET_COUNT_Y))*(TILESET_TILE + TILESET_SPACING);
                    context.drawImage(tileset, sx, sy, TILESET_TILE, TILESET_TILE, x*TILE, (y-1)*TILE, TILESET_TILE, TILESET_TILE);
                }
                idx++;
            }
        }
    }
}